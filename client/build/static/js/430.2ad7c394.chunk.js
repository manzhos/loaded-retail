"use strict";(self.webpackChunkloaded_retail=self.webpackChunkloaded_retail||[]).push([[430],{4920:function(e,n,t){t.d(n,{Z:function(){return a}});t(7313);var i=t(2524),r=t(7829),s=t(6417);function a(e){let{icon:n,sx:t,...a}=e;return(0,s.jsx)(r.Z,{component:i.JO,icon:n,sx:{...t},...a})}},2241:function(e,n,t){t.d(n,{Z:function(){return a}});t(7313);var i=t(501),r=t(1113),s=t(6417);function a(e){let{searchQuery:n="",...t}=e;return(0,s.jsxs)(i.Z,{...t,children:[(0,s.jsx)(r.Z,{gutterBottom:!0,align:"center",variant:"subtitle1",children:"Not found"}),(0,s.jsxs)(r.Z,{variant:"body2",align:"center",children:["No results found for \xa0",(0,s.jsxs)("strong",{children:['"',n,'"']}),". Try checking for typos or using complete words."]})]})}},2430:function(e,n,t){t.r(n),t.d(n,{default:function(){return H}});var i=t(3448),r=t(6031),s=t(7313),a=t(778),l=t(6287),o=t(9793),c=t(178),d=t(5898),h=t(1113),u=t(9099),m=t(7887),x=t(7829),p=t(9019),g=t(4631),j=t(1550),Z=t(3306),f=t(4256),w=t(1405),b=t(3428),y=t(1629),v=t(6835),C=t(3467),P=t(4076),S=t(7478),k=t(6330),R=t(7649),I=t(3477),E=t(2558),W=t(6417);const D={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function F(e){let{order:n,orderBy:t,rowCount:i,headLabel:r,numSelected:s,onRequestSort:a,onSelectAllClick:l}=e;return(0,W.jsx)(I.Z,{children:(0,W.jsxs)(P.Z,{children:[(0,W.jsx)(S.Z,{padding:"checkbox",children:(0,W.jsx)(k.Z,{indeterminate:s>0&&s<i,checked:i>0&&s===i,onChange:l})}),r.map((e=>{return(0,W.jsx)(S.Z,{align:e.alignRight?"right":"left",sortDirection:t===e.id&&n,children:(0,W.jsxs)(E.Z,{hideSortIcon:!0,active:t===e.id,direction:t===e.id?n:"asc",onClick:(i=e.id,e=>{"role"===i&&(i="usertype"),a(e,i)}),children:[e.label,t===e.id?(0,W.jsx)(x.Z,{sx:{...D},children:"desc"===n?"sorted descending":"sorted ascending"}):null]})},e.id);var i}))]})})}var L=t(7592),O=t(9289),T=t(7843),U=t(1727),_=t(1689),$=t(7131),A=t(4920);const N=(0,L.ZP)(O.Z)((e=>{let{theme:n}=e;return{height:96,display:"flex",justifyContent:"space-between",padding:n.spacing(0,1,0,3)}})),q=(0,L.ZP)(T.Z)((e=>{let{theme:n}=e;return{width:240,transition:n.transitions.create(["box-shadow","width"],{easing:n.transitions.easing.easeInOut,duration:n.transitions.duration.shorter}),"&.Mui-focused":{width:320},"& fieldset":{borderWidth:"1px !important",borderColor:`${n.palette.grey[50032]} !important`}}}));function V(e){let{numSelected:n,onFilterName:t,onDelete:i}=e;const[r,a]=(0,s.useState)("");return(0,W.jsxs)(N,{sx:{...n>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[n>0?(0,W.jsxs)(h.Z,{component:"div",variant:"subtitle1",children:[n," selected"]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(q,{value:r,onChange:e=>{a(e.target.value),t(e.target.value)},placeholder:"Search user...",startAdornment:(0,W.jsx)(U.Z,{position:"start",children:(0,W.jsx)(A.Z,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),(0,W.jsx)("div",{style:{width:"20px"},children:"\xa0"})]}),n>0?(0,W.jsx)(_.Z,{title:"Delete",children:(0,W.jsx)($.Z,{onClick:()=>{i()},children:(0,W.jsx)(A.Z,{icon:"eva:trash-2-fill"})})}):(0,W.jsx)(_.Z,{title:"Filter list",children:(0,W.jsx)($.Z,{children:(0,W.jsx)(A.Z,{icon:"ic:round-filter-list"})})})]})}var G=t(9601),B=t(4748),Y=t(3213);function z(e){let{id:n,onChange:t}=e;const i=(0,s.useRef)(null),[r,o]=(0,s.useState)(!1),{request:c}=(0,a.i)();return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)($.Z,{ref:i,onClick:()=>o(!0),children:(0,W.jsx)(A.Z,{icon:"eva:more-vertical-fill",width:20,height:20})}),(0,W.jsx)(G.Z,{open:r,anchorEl:i.current,onClose:()=>o(!1),PaperProps:{sx:{width:200,maxWidth:"100%"}},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,W.jsxs)(w.Z,{sx:{color:"text.secondary"},onClick:async e=>{e.preventDefault();try{await c(`${l.Z.API_URL}api/deluser/${n}`,"get",null,{}),o(!1),t(!0)}catch(i){console.log("error:",i)}},children:[(0,W.jsx)(B.Z,{children:(0,W.jsx)(A.Z,{icon:"eva:trash-2-outline",width:24,height:24})}),(0,W.jsx)(Y.Z,{primary:"Delete",primaryTypographyProps:{variant:"body2"}})]})})]})}var Q=t(2241);const J=[{id:"name",label:"Name",alignRight:!1},{id:"email",label:"Email",alignRight:!1},{id:"phone",label:"Phone",alignRight:!1},{id:"role",label:"Role",alignRight:!1},{id:"act",label:"",alignRight:!1}];function M(e,n,t){return n[t]<e[t]?-1:n[t]>e[t]?1:0}function H(){const[e,n]=(0,s.useState)([]),[t,I]=(0,s.useState)(3),[E,D]=(0,s.useState)([]),[L,O]=(0,s.useState)(""),[T,U]=(0,s.useState)("asc"),[_,$]=(0,s.useState)("name"),[N,q]=(0,s.useState)(0),[G,B]=(0,s.useState)(5),[Y,H]=(0,s.useState)("add"),[K,X]=(0,s.useState)({}),{loading:ee,request:ne}=(0,a.i)(),te=(0,s.useCallback)((async()=>{try{const e=await ne(`${l.Z.API_URL}api/user`,"GET",null,{});n(e)}catch(e){console.log("error:",e)}}),[ne,e]);(0,s.useEffect)((()=>{te()}),[]);const ie=n=>{if(n.target.checked){const n=e.map((e=>e.name));D(n)}else D([])},re=function(e,n,t){const i=e.map(((e,n)=>[e,n]));return i.sort(((e,t)=>{const i=n(e[0],t[0]);return 0!==i?i:e[1]-t[1]})),t?(0,r.filter)(e,(e=>-1!==e.name.toLowerCase().indexOf(t.toLowerCase())||-1!==e.name.toLowerCase().indexOf(t.toLowerCase()))):i.map((e=>e[0]))}(e,function(e,n){return"desc"===e?(e,t)=>M(e,t,n):(e,t)=>-M(e,t,n)}(T,_),L),se=0===re.length,ae=e=>{O(e)},le=(e,n)=>{U(_===n&&"asc"===T?"desc":"asc"),$(n)},oe=(e,n)=>{q(n)},ce=e=>{B(parseInt(e.target.value,10)),q(0)},de=(e,n,t,i,r,s,a)=>{console.log(`Edit User ${n}`),X({id:n,firstname:t,lastname:i,email:r,phone:s,role:a}),me("edit")},[he,ue]=(0,s.useState)(!1),me=e=>{H(e),ue(!0)},xe=()=>ue(!1),pe=async e=>{e.preventDefault();const n=new FormData(e.currentTarget);if(n.get("firstname"))try{await ne(`${l.Z.API_URL}api/user`,"POST",{firstname:n.get("firstname"),lastname:n.get("lastname"),email:n.get("email"),phone:n.get("phone"),password:n.get("password"),usertype_id:t})&&(ue(!1),je())}catch(i){console.log("error:",i)}else alert("You need to fill fields.")},ge=async e=>{e.preventDefault();const n=new FormData(e.currentTarget);try{await ne(`${l.Z.API_URL}api/user/${K.id}`,"POST",{firstname:n.get("firstname"),lastname:n.get("lastname"),email:n.get("email"),phone:n.get("phone"),password:n.get("password"),usertype_id:t})&&(ue(!1),je())}catch(i){console.log("error:",i)}},je=()=>{te()},Ze=()=>{E.map((n=>{try{const t=e.filter((e=>e.name===n))[0].id;ne(`${l.Z.API_URL}api/user/${t}`,"DELETE",null,{}),je()}catch(t){console.log("error:",t)}}))};return ee?(0,W.jsx)(o.Z,{}):(0,W.jsxs)(c.Z,{children:[(0,W.jsxs)(d.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[(0,W.jsx)(h.Z,{variant:"h4",gutterBottom:!0,children:"Users"}),(0,W.jsx)(u.Z,{variant:"contained",onClick:()=>{me("add")},startIcon:(0,W.jsx)(A.Z,{icon:"eva:plus-fill"}),children:"New User"}),(0,W.jsx)(m.Z,{open:he,onClose:xe,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,W.jsx)(c.Z,{component:"main",maxWidth:"md",disableGutters:!0,children:(0,W.jsx)("div",{className:"login-modal",children:(0,W.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,W.jsxs)(h.Z,{component:"h1",variant:"h5",children:[(0,W.jsx)("span",{style:{textTransform:"uppercase"},children:Y})," USER"]}),(0,W.jsxs)(x.Z,{component:"form",noValidate:!0,onSubmit:"add"===Y?pe:ge,sx:{mt:3},style:{width:"100%",textAlign:"center"},children:[(0,W.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,W.jsxs)(p.ZP,{container:!0,spacing:2,item:!0,xs:12,sm:12,children:[(0,W.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,W.jsx)(g.Z,{autoComplete:"firstname",name:"firstname",required:!0,fullWidth:!0,id:"firstname",label:"Name",defaultValue:K.firstname,autoFocus:!0})}),(0,W.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,W.jsx)(g.Z,{autoComplete:"lastname",name:"lastname",required:!0,fullWidth:!0,id:"lastname",label:"Surname",defaultValue:K.lastname,autoFocus:!0})})]}),(0,W.jsxs)(p.ZP,{container:!0,spacing:2,item:!0,xs:12,sm:12,children:[(0,W.jsx)(p.ZP,{item:!0,xs:12,sm:2,children:"\xa0"}),(0,W.jsx)(p.ZP,{item:!0,xs:12,sm:4,children:(0,W.jsxs)(j.Z,{sx:{width:1},children:[(0,W.jsx)(Z.Z,{id:"role-select",children:"Role"}),(0,W.jsx)(f.Z,{labelId:"role-select",id:"role-select",name:"usertype_id",value:t,label:"Role",defaultValue:K.role,onChange:e=>{I(e.target.value)},children:l.Z.USERTYPE.map(((e,n)=>(0,W.jsx)(w.Z,{value:n,children:(0,i.G)(e)},n)))})]})}),(0,W.jsx)(p.ZP,{item:!0,xs:12,sm:4,children:(0,W.jsx)(g.Z,{name:"password",fullWidth:!0,id:"password",label:"add"===Y?"Password":"New password if needed",autoFocus:!0})}),(0,W.jsx)(p.ZP,{item:!0,xs:12,sm:2,children:"\xa0"})]}),(0,W.jsxs)(p.ZP,{container:!0,spacing:2,item:!0,xs:12,sm:12,children:[(0,W.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,W.jsx)(g.Z,{autoComplete:"email",name:"email",fullWidth:!0,id:"email",label:"Email",defaultValue:K.email,autoFocus:!0})}),(0,W.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,W.jsx)(g.Z,{autoComplete:"phone",name:"phone",fullWidth:!0,id:"phone",label:"Phone",defaultValue:K.phone,autoFocus:!0})})]})]}),(0,W.jsx)(u.Z,{type:"submit",variant:"contained",sx:{mt:3,mb:2},style:{padding:"8px 40px 5px"},children:"Save"})]})]})})})})]}),(0,W.jsxs)(b.Z,{children:[(0,W.jsx)(V,{numSelected:E.length,onFilterName:ae,onDelete:Ze}),(0,W.jsx)(y.Z,{sx:{minWidth:800},children:(0,W.jsxs)(v.Z,{children:[(0,W.jsx)(F,{order:T,orderBy:_,headLabel:J,rowCount:e.length,numSelected:E.length,onRequestSort:le,onSelectAllClick:ie}),(0,W.jsxs)(C.Z,{children:[re.slice(N*G,N*G+G).map((e=>{const{id:n,firstname:t,lastname:r,email:s,phone:a,usertype_id:o}=e,c=-1!==E.indexOf(t);return(0,W.jsxs)(P.Z,{hover:!0,tabIndex:-1,role:"checkbox",selected:c,"aria-checked":c,style:{cursor:"pointer"},children:[(0,W.jsx)(S.Z,{padding:"checkbox",children:(0,W.jsx)(k.Z,{checked:c,onChange:e=>((e,n)=>{const t=E.indexOf(n);let i=[];-1===t?i=i.concat(E,n):0===t?i=i.concat(E.slice(1)):t===E.length-1?i=i.concat(E.slice(0,-1)):t>0&&(i=i.concat(E.slice(0,t),E.slice(t+1))),D(i)})(0,t)})}),(0,W.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>de(0,n,t,r,s,a,o),children:(0,W.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,W.jsxs)(h.Z,{variant:"body1",noWrap:!0,children:[t?(0,i.G)(t)+" ":"",r?(0,i.G)(r):""]})})}),(0,W.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>de(0,n,t,r,s,a,o),children:(0,W.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,W.jsx)(h.Z,{variant:"body1",noWrap:!0,children:s})})}),(0,W.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>de(0,n,t,r,s,a,o),children:(0,W.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,W.jsx)(h.Z,{variant:"body1",noWrap:!0,children:a})})}),(0,W.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>de(0,n,t,r,s,a,o),children:(0,W.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,W.jsx)(h.Z,{variant:"body1",noWrap:!0,children:l.Z.USERTYPE[o]})})}),(0,W.jsx)(S.Z,{align:"right",children:(0,W.jsx)(z,{id:n,user:e,onChange:je})})]},n)})),!1]}),se&&(0,W.jsx)(C.Z,{children:(0,W.jsx)(P.Z,{children:(0,W.jsx)(S.Z,{align:"center",colSpan:6,sx:{py:3},children:(0,W.jsx)(Q.Z,{searchQuery:L})})})})]})}),(0,W.jsx)(R.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:e.length,rowsPerPage:G,page:N,onPageChange:oe,onRowsPerPageChange:ce})]})]})}}}]);
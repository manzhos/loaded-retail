"use strict";(self.webpackChunkloaded_retail=self.webpackChunkloaded_retail||[]).push([[430],{4920:function(e,t,n){n.d(t,{Z:function(){return a}});n(7313);var i=n(2524),s=n(7829),r=n(6417);function a(e){let{icon:t,sx:n,...a}=e;return(0,r.jsx)(s.Z,{component:i.JO,icon:t,sx:{...n},...a})}},2241:function(e,t,n){n.d(t,{Z:function(){return a}});n(7313);var i=n(501),s=n(1113),r=n(6417);function a(e){let{searchQuery:t="",...n}=e;return(0,r.jsxs)(i.Z,{...n,children:[(0,r.jsx)(s.Z,{gutterBottom:!0,align:"center",variant:"subtitle1",children:"Not found"}),(0,r.jsxs)(s.Z,{variant:"body2",align:"center",children:["No results found for \xa0",(0,r.jsxs)("strong",{children:['"',t,'"']}),". Try checking for typos or using complete words."]})]})}},2430:function(e,t,n){n.r(t),n.d(t,{default:function(){return H}});var i=n(3448),s=n(6031),r=n(7313),a=n(778),l=n(6287),o=n(9793),c=n(178),d=n(5898),h=n(1113),u=n(9099),m=n(7887),x=n(7829),p=n(9019),g=n(4631),Z=n(1550),j=n(3306),f=n(4256),w=n(1405),y=n(3428),v=n(1629),b=n(6835),P=n(3467),C=n(4076),S=n(7478),k=n(6330),_=n(7649),R=n(3477),I=n(2558),E=n(6417);const W={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function L(e){let{order:t,orderBy:n,rowCount:i,headLabel:s,numSelected:r,onRequestSort:a,onSelectAllClick:l}=e;return(0,E.jsx)(R.Z,{children:(0,E.jsxs)(C.Z,{children:[(0,E.jsx)(S.Z,{padding:"checkbox",children:(0,E.jsx)(k.Z,{indeterminate:r>0&&r<i,checked:i>0&&r===i,onChange:l})}),s.map((e=>{return(0,E.jsx)(S.Z,{align:e.alignRight?"right":"left",sortDirection:n===e.id&&t,children:(0,E.jsxs)(I.Z,{hideSortIcon:!0,active:n===e.id,direction:n===e.id?t:"asc",onClick:(i=e.id,e=>{"role"===i&&(i="usertype"),a(e,i)}),children:[e.label,n===e.id?(0,E.jsx)(x.Z,{sx:{...W},children:"desc"===t?"sorted descending":"sorted ascending"}):null]})},e.id);var i}))]})})}var D=n(7592),F=n(9289),T=n(7843),U=n(1727),O=n(1689),$=n(7131),A=n(4920);const N=(0,D.ZP)(F.Z)((e=>{let{theme:t}=e;return{height:96,display:"flex",justifyContent:"space-between",padding:t.spacing(0,1,0,3)}})),q=(0,D.ZP)(T.Z)((e=>{let{theme:t}=e;return{width:240,transition:t.transitions.create(["box-shadow","width"],{easing:t.transitions.easing.easeInOut,duration:t.transitions.duration.shorter}),"&.Mui-focused":{width:320},"& fieldset":{borderWidth:"1px !important",borderColor:`${t.palette.grey[50032]} !important`}}}));function G(e){let{numSelected:t,onFilterName:n,onDelete:i}=e;const[s,a]=(0,r.useState)("");return(0,E.jsxs)(N,{sx:{...t>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[t>0?(0,E.jsxs)(h.Z,{component:"div",variant:"subtitle1",children:[t," selected"]}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(q,{value:s,onChange:e=>{a(e.target.value),n(e.target.value)},placeholder:"Search user...",startAdornment:(0,E.jsx)(U.Z,{position:"start",children:(0,E.jsx)(A.Z,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),(0,E.jsx)("div",{style:{width:"20px"},children:"\xa0"})]}),t>0?(0,E.jsx)(O.Z,{title:"Delete",children:(0,E.jsx)($.Z,{onClick:()=>{i()},children:(0,E.jsx)(A.Z,{icon:"eva:trash-2-fill"})})}):(0,E.jsx)(O.Z,{title:"Filter list",children:(0,E.jsx)($.Z,{children:(0,E.jsx)(A.Z,{icon:"ic:round-filter-list"})})})]})}var V=n(9601),B=n(4748),Y=n(3213);function z(e){let{id:t,onChange:n}=e;const i=(0,r.useRef)(null),[s,o]=(0,r.useState)(!1),{request:c}=(0,a.i)();return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)($.Z,{ref:i,onClick:()=>o(!0),children:(0,E.jsx)(A.Z,{icon:"eva:more-vertical-fill",width:20,height:20})}),(0,E.jsx)(V.Z,{open:s,anchorEl:i.current,onClose:()=>o(!1),PaperProps:{sx:{width:200,maxWidth:"100%"}},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:(0,E.jsxs)(w.Z,{sx:{color:"text.secondary"},onClick:async e=>{e.preventDefault();try{await c(`${l.Z.API_URL}api/deluser/${t}`,"get",null,{}),o(!1),n(!0)}catch(i){console.log("error:",i)}},children:[(0,E.jsx)(B.Z,{children:(0,E.jsx)(A.Z,{icon:"eva:trash-2-outline",width:24,height:24})}),(0,E.jsx)(Y.Z,{primary:"Delete",primaryTypographyProps:{variant:"body2"}})]})})]})}var Q=n(2241);const J=[{id:"name",label:"Name",alignRight:!1},{id:"role",label:"Role",alignRight:!1},{id:"store",label:"Store",alignRight:!1},{id:"email",label:"Email",alignRight:!1},{id:"phone",label:"Phone",alignRight:!1},{id:"act",label:"",alignRight:!1}];function M(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}function H(){const[e,t]=(0,r.useState)([]),[n,R]=(0,r.useState)([]),[I,W]=(0,r.useState)(""),[D,F]=(0,r.useState)("asc"),[T,U]=(0,r.useState)("name"),[O,$]=(0,r.useState)(0),[N,q]=(0,r.useState)(5),[V,B]=(0,r.useState)("add"),[Y,H]=(0,r.useState)({}),[K,X]=(0,r.useState)([]),[ee,te]=(0,r.useState)({}),{loading:ne,request:ie}=(0,a.i)(),se=(0,r.useCallback)((async()=>{try{const e=await ie(`${l.Z.API_URL}api/user`,"GET",null,{});t(e)}catch(e){console.log("error:",e)}}),[ie,e]);(0,r.useEffect)((()=>{se()}),[]);const re=(0,r.useCallback)((async()=>{try{const e=await ie(`${l.Z.API_URL}api/store`,"GET",null,{});X(e)}catch(e){console.log("error:",e)}}),[ie,K]);(0,r.useEffect)((()=>{re()}),[]);const ae=t=>{if(t.target.checked){const t=e.map((e=>e.name));R(t)}else R([])},le=function(e,t,n){const i=e.map(((e,t)=>[e,t]));return i.sort(((e,n)=>{const i=t(e[0],n[0]);return 0!==i?i:e[1]-n[1]})),n?(0,s.filter)(e,(e=>-1!==e.name.toLowerCase().indexOf(n.toLowerCase())||-1!==e.name.toLowerCase().indexOf(n.toLowerCase()))):i.map((e=>e[0]))}(e,function(e,t){return"desc"===e?(e,n)=>M(e,n,t):(e,n)=>-M(e,n,t)}(D,T),I),oe=0===le.length,ce=e=>{W(e)},de=(e,t)=>{F(T===t&&"asc"===D?"desc":"asc"),U(t)},he=(e,t)=>{$(t)},ue=e=>{q(parseInt(e.target.value,10)),$(0)},me=(e,t,n,i,s,r,a,l)=>{console.log(`Edit User ${t}`),H({id:t,firstname:n,lastname:i,email:s,phone:r,usertype_id:a,store_id:l}),ge("edit")},[xe,pe]=(0,r.useState)(!1),ge=e=>{"add"===e&&H({}),B(e),pe(!0)},Ze=()=>pe(!1),je=async e=>{e.preventDefault();const t=new FormData(e.currentTarget);if(t.get("firstname"))try{await ie(`${l.Z.API_URL}api/user`,"POST",{firstname:t.get("firstname"),lastname:t.get("lastname"),email:t.get("email"),phone:t.get("phone"),password:t.get("password"),store_id:t.get("store_id"),usertype_id:t.get("usertype_id")})&&(pe(!1),we())}catch(n){console.log("error:",n)}else alert("You need to fill fields.")},fe=async e=>{e.preventDefault();const t=new FormData(e.currentTarget);try{await ie(`${l.Z.API_URL}api/user/${Y.id}`,"POST",{firstname:t.get("firstname"),lastname:t.get("lastname"),email:t.get("email"),phone:t.get("phone"),password:t.get("password"),store_id:t.get("store_id"),usertype_id:t.get("usertype_id")})&&(pe(!1),we())}catch(n){console.log("error:",n)}},we=()=>{se()},ye=()=>{n.map((t=>{try{const n=e.filter((e=>e.name===t))[0].id;ie(`${l.Z.API_URL}api/user/${n}`,"DELETE",null,{}),we()}catch(n){console.log("error:",n)}}))};return ne?(0,E.jsx)(o.Z,{}):(0,E.jsxs)(c.Z,{children:[(0,E.jsxs)(d.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[(0,E.jsx)(h.Z,{variant:"h4",gutterBottom:!0,children:"Users"}),(0,E.jsx)(u.Z,{variant:"contained",onClick:()=>{ge("add")},startIcon:(0,E.jsx)(A.Z,{icon:"eva:plus-fill"}),children:"New User"}),(0,E.jsx)(m.Z,{open:xe,onClose:Ze,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,E.jsx)(c.Z,{component:"main",maxWidth:"md",disableGutters:!0,children:(0,E.jsx)("div",{className:"login-modal",children:(0,E.jsxs)(x.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,E.jsxs)(h.Z,{component:"h1",variant:"h5",children:[(0,E.jsx)("span",{style:{textTransform:"uppercase"},children:V})," USER"]}),(0,E.jsxs)(x.Z,{component:"form",noValidate:!0,onSubmit:"add"===V?je:fe,sx:{mt:3},style:{width:"100%",textAlign:"center"},children:[(0,E.jsxs)(p.ZP,{container:!0,spacing:2,children:[(0,E.jsxs)(p.ZP,{container:!0,spacing:2,item:!0,xs:12,sm:12,children:[(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,E.jsx)(g.Z,{autoComplete:"firstname",name:"firstname",required:!0,fullWidth:!0,id:"firstname",label:"Name",defaultValue:Y.firstname,autoFocus:!0})}),(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,E.jsx)(g.Z,{autoComplete:"lastname",name:"lastname",required:!0,fullWidth:!0,id:"lastname",label:"Surname",defaultValue:Y.lastname,autoFocus:!0})})]}),(0,E.jsxs)(p.ZP,{container:!0,spacing:2,item:!0,xs:12,sm:12,children:[(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:2,children:"\xa0"}),(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:4,children:(0,E.jsxs)(Z.Z,{sx:{width:1},children:[(0,E.jsx)(j.Z,{id:"role-select",children:"Role"}),(0,E.jsx)(f.Z,{labelId:"role-select",id:"role-select",name:"usertype_id",label:"Role",value:Y.usertype_id,onChange:e=>{H({...Y,usertype_id:e.target.value})},children:l.Z.USERTYPE.map(((e,t)=>(0,E.jsx)(w.Z,{value:t,children:(0,i.G)(e)},t)))})]})}),(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:4,children:(0,E.jsx)(g.Z,{name:"password",fullWidth:!0,id:"password",label:"add"===V?"Password":"New password if needed",autoFocus:!0})}),(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:2,children:"\xa0"})]}),(0,E.jsxs)(p.ZP,{container:!0,spacing:2,item:!0,xs:12,sm:12,children:[(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,E.jsx)(g.Z,{autoComplete:"email",name:"email",fullWidth:!0,id:"email",label:"Email",defaultValue:Y.email,autoFocus:!0})}),(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,E.jsx)(g.Z,{autoComplete:"phone",name:"phone",fullWidth:!0,id:"phone",label:"Phone",defaultValue:Y.phone,autoFocus:!0})}),Y.usertype_id>0&&(0,E.jsxs)(p.ZP,{container:!0,item:!0,xs:12,sm:12,children:[(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:3,children:"\xa0"}),(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:6,children:(0,E.jsxs)(Z.Z,{sx:{width:1},children:[(0,E.jsx)(j.Z,{id:"store-select",children:"Store"}),(0,E.jsx)(f.Z,{labelId:"store-select",id:"store-select",name:"store_id",value:null===ee||void 0===ee?void 0:ee.id,label:"Store",defaultValue:Y.store_id,onChange:e=>{te(K.find((t=>t.id===e.target.value)))},children:K.map(((e,t)=>(0,E.jsx)(w.Z,{value:e.id,children:e.name},t)))})]})}),(0,E.jsx)(p.ZP,{item:!0,xs:12,sm:3,children:"\xa0"})]})]})]}),(0,E.jsx)(u.Z,{type:"submit",variant:"contained",sx:{mt:3,mb:2},style:{padding:"8px 40px 5px"},children:"Save"})]})]})})})})]}),(0,E.jsxs)(y.Z,{children:[(0,E.jsx)(G,{numSelected:n.length,onFilterName:ce,onDelete:ye}),(0,E.jsx)(v.Z,{sx:{minWidth:800},children:(0,E.jsxs)(b.Z,{children:[(0,E.jsx)(L,{order:D,orderBy:T,headLabel:J,rowCount:e.length,numSelected:n.length,onRequestSort:de,onSelectAllClick:ae}),(0,E.jsxs)(P.Z,{children:[le.slice(O*N,O*N+N).map((e=>{var t;const{id:s,firstname:r,lastname:a,email:o,phone:c,usertype_id:u,store_id:m}=e,x=-1!==n.indexOf(r);return(0,E.jsxs)(C.Z,{hover:!0,tabIndex:-1,role:"checkbox",selected:x,"aria-checked":x,style:{cursor:"pointer"},children:[(0,E.jsx)(S.Z,{padding:"checkbox",children:(0,E.jsx)(k.Z,{checked:x,onChange:e=>((e,t)=>{const i=n.indexOf(t);let s=[];-1===i?s=s.concat(n,t):0===i?s=s.concat(n.slice(1)):i===n.length-1?s=s.concat(n.slice(0,-1)):i>0&&(s=s.concat(n.slice(0,i),n.slice(i+1))),R(s)})(0,r)})}),(0,E.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>me(0,s,r,a,o,c,u,m),children:(0,E.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,E.jsxs)(h.Z,{variant:"body1",noWrap:!0,children:[r?(0,i.G)(r)+" ":"",a?(0,i.G)(a):""]})})}),(0,E.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>me(0,s,r,a,o,c,u,m),children:(0,E.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,E.jsx)(h.Z,{variant:"body1",noWrap:!0,children:l.Z.USERTYPE[u]})})}),(0,E.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>me(0,s,r,a,o,c,u,m),children:(0,E.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,E.jsx)(h.Z,{variant:"body1",noWrap:!0,children:null!==m?null===(t=K.find((e=>e.id===m)))||void 0===t?void 0:t.name:""})})}),(0,E.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>me(0,s,r,a,o,c,u,m),children:(0,E.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,E.jsx)(h.Z,{variant:"body1",noWrap:!0,children:o})})}),(0,E.jsx)(S.Z,{component:"th",scope:"row",padding:"normal",onClick:e=>me(0,s,r,a,o,c,u,m),children:(0,E.jsx)(d.Z,{direction:"row",alignItems:"center",spacing:2,children:(0,E.jsx)(h.Z,{variant:"body1",noWrap:!0,children:c})})}),(0,E.jsx)(S.Z,{align:"right",children:(0,E.jsx)(z,{id:s,user:e,onChange:we})})]},s)})),!1]}),oe&&(0,E.jsx)(P.Z,{children:(0,E.jsx)(C.Z,{children:(0,E.jsx)(S.Z,{align:"center",colSpan:6,sx:{py:3},children:(0,E.jsx)(Q.Z,{searchQuery:I})})})})]})}),(0,E.jsx)(_.Z,{rowsPerPageOptions:[5,10,25],component:"div",count:e.length,rowsPerPage:N,page:O,onPageChange:he,onRowsPerPageChange:ue})]})]})}}}]);